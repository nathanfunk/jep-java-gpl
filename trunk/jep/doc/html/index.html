<html><!-- #BeginTemplate "/Templates/maintemplate.dwt" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!-- #BeginEditable "doctitle" --> 
<title>JEP - Java Math Expression Parser</title>
<!-- #EndEditable --> 
<link rel="stylesheet" type="text/css" href="main.css" title="style1">
</head>

<body>



<!-- NAVIGATION ---------------------------------------------------- -->
<div id="navcontainer"> 
  <ul>
    <li><a href="../javadoc/index.html" target="_blank">JavaDoc*</a></li>
  </ul>

<h1>JEP</h1>
  <ul>
    <li><a href="index.html">Basic Usage</a></li>
    <li><a href="variables.html">Variables</a></li>
    <li><a href="types.html">Data types</a></li>
    <li><a href="op_and_func.html">Operators &amp; Functions</a></li>
    <li><a href="grammar.html">Grammar</a></li>
    <li><a href="cust_func.html">Custom Functions</a></li>
    <li><a href="newfeatures.html">New Features</a></li>
    <li><a href="faq.html">FAQ</a></li>
    <li><a href="version.html">Version History</a></li>
  </ul>

<h1>Extensions</h1>
  <ul>
    <li><a href="djep/index.html">DJEP</a></li>
    <li><a href="djep/XJep.html">XJep</a></li>
    <li><a href="djep/DJep.html">Differentiation</a></li>
    <li><a href="djep/VectorJep.html">Vectors &amp; Matrices</a></li>
    <li><a href="djep/GroupJep.html">Groups</a></li>
    <li><a href="djep/AddingOperators.html">Adding Operators</a></li>
    <li><a href="djep/version.html">Version History</a></li>
  </ul>
</div>



<div id="centercontent">
<!-- CENTER CONTENT -------------------------------------------------- -->
<!-- #BeginEditable "Text" --> 
  <h1><a name="top"></a>Basic Usage</h1>
  <ul>
    <li><a href="#evaluatingexpressions">Evaluating expressions</a></li>
    <li><a href="#errorhandling">Error handling</a></li>
    <li><a href="#implicitmul">Implicit multiplication</a></li>
    <li><a href="#allowingundeclared">Allowing undeclared variables</a></li>
    <li><a href="#obtainingalist">Obtaining a list of variables</a></li>
    <li><a href="#complexnumbers">Complex numbers</a></li>
    <li><a href="#usingvectors">Using Vectors</a></li>
    <li><a href="#usingstrings">Using Strings</a></li>
    <li><a href="#customtypes">Custom types</a></li>
    <li><a href="#manipulating">Manipulating expressions</a></li>
    <li><a href="#usingcustomnumberclasses">Using custom number classes</a></li>
  </ul>
  <p>Using the JEP package of classes in your project is simple! The following 
    steps will get you started quickly.</p>
  <ol>
    <li>Download the JEP package</li>
    <li>Unpack the archive</li>
    <li>Move the jep-x.x.x.jar file to a directory of your choice (optional)</li>
    <li>IMPORTANT: For the Java compiler to be able to find the JEP classes when 
      compiling your program, it needs to know their location. So you will need 
      to add the location of the .jar file to your CLASSPATH environment variable 
      (if you don't know how, <a href="http://java.sun.com/j2se/1.4/docs/tooldocs/windows/classpath.html" target="_blank">read 
      this</a>). Your CLASSPATH variable should contain something like C:\java\packages\jep-x.x.x.jar, 
      depending on where you place the jar file. Alternatively you may need to 
      set the location of the jar archive in your Java IDE so that the compiler 
      finds the library.</li>
    <li>In your program, create a new parser object with 
      <pre>org.nfunk.jep.JEP myParser = new org.nfunk.jep.<a href="../javadoc/org/nfunk/jep/JEP.html" target="_blank">JEP</a>();</pre>
    </li>
    <li>Add the standard functions and constants if you want to be able to evaluate 
      expressions with trigonometric functions and the constants <i>pi</i> and 
      <i>e</i>. 
      <pre>myParser.<a href="../javadoc/org/nfunk/jep/JEP.html#addStandardFunctions()" target="_blank">addStandardFunctions()</a>;
myParser.<a href="../javadoc/org/nfunk/jep/JEP.html#addStandardConstants()" target="_blank">addStandardConstants()</a>;</pre>
    </li>
    <li> By default you need to specify which variables can be used in the expression. 
      If a variable is not added before the expression is parsed, the parser will 
      claim that the expression is invalid (this can be changed by <a href="#allowingundeclared">allowing 
      undeclared variables</a>).<br>
      To add the variable <i>x</i> and initialize it to 0 for example, write 
      <pre>myParser.<a href="../javadoc/org/nfunk/jep/JEP.html#addVariable(java.lang.String, double)" target="_blank">addVariable(&quot;x&quot;, 0)</a>;</pre>
    </li>
    <li>Parse the expression, and evaluate it: 
      <pre>myParser.<a href="../javadoc/org/nfunk/jep/JEP.html#parseExpression(java.lang.String)" target="_blank">parseExpression(ExpressionString)</a>;
result = myParser.<a href="../javadoc/org/nfunk/jep/JEP.html#getValue()" target="_blank">getValue()</a>;</pre>
    </li>
    <li> The values of variables can be changed with the <a href="../javadoc/org/nfunk/jep/JEP.html#addVariable(java.lang.String, double)" target="_blank">addVariable(String, 
      double)</a> method.<br>
    </li>
  </ol>
  <p>The code of the sample applets provide more extensive look at how the parser 
    methods are used.</p>
  <!-- #BeginLibraryItem "/Library/top bar.lbi" -->
<div class="topbar"><a href="#top"><img src="img/top.gif" width="38" height="15" name="top"></a></div>
<!-- #EndLibraryItem --> 
  <h2><a name="evaluatingexpressions"></a>Evaluating expressions</h2>
  <p>Four methods for evaluating an expression are available:</p>
  <ul>
    <li><a href="../javadoc/org/nfunk/jep/JEP.html#getValue()" target="_blank">getValue()</a>: 
      Use this if you are expecting a normal floating point value.</li>
    <li><a href="../javadoc/org/nfunk/jep/JEP.html#getComplexValue()" target="_blank">getComplexValue()</a>: 
      Use this if you are expecting a complex value.</li>
    <li><a href="../javadoc/org/nfunk/jep/JEP.html#getValueAsObject()" target="_blank">getValueAsObject()</a>: 
      Returns the result as an Object (any type)</li>
    <li><a href="../javadoc/org/nfunk/jep/JEP.html#evaluate(Node)" target="_blank">evaluate(Node 
      root)</a>: Evaluates a tree with from a root node and returns the result 
      as an Object.</li>
  </ul>
  <p>The first two methods call <a href="../javadoc/org/nfunk/jep/JEP.html#getValueAsObject()" target="_blank">getValueAsObject()</a> 
    internally, and perform the necessary conversions into either a <code>double</code> 
    value, or a <code>Complex</code> object.</p>
  <!-- #BeginLibraryItem "/Library/top bar.lbi" -->
<div class="topbar"><a href="#top"><img src="img/top.gif" width="38" height="15" name="top"></a></div>
<!-- #EndLibraryItem --> 
  <h2><a name="errorhandling"></a>Error handling</h2>
  <p>Errors can occur both while parsing an expression and while evaluating an 
    expression. The <a href="../javadoc/org/nfunk/jep/JEP.html#hasError()" target="_blank">hasError()</a> 
    method reports whether an error has occured during the most recent action 
    (either parsing or evaluation). If the result is <code>true</code>, you can 
    then use <a href="../javadoc/org/nfunk/jep/JEP.html#getErrorInfo()" target="_blank">getErrorInfo()</a> 
    to obtain further information on the errors that have occured.</p>
  <!-- #BeginLibraryItem "/Library/top bar.lbi" -->
<div class="topbar"><a href="#top"><img src="img/top.gif" width="38" height="15" name="top"></a></div>
<!-- #EndLibraryItem --> 
  <h2><a name="alternate"></a>Alternate parsing and evaluation functions</h2>
  <p>There is an alternative method to parsing and evaluating expression which 
    allows a little more flexibility in applications especially when working with 
    a set of related equations. These are: </p>
  <pre>public Node <a href="../javadoc/org/nfunk/jep/JEP.html#parse(java.lang.String)">parse(String expression)</a> throws ParseException<br>public Object <a href="../javadoc/org/nfunk/jep/JEP.html#evaluate(org.nfunk.jep.Node)">evaluate(Node node)</a> throws Exception</pre>
  which parse and evaluate the expression. These can be used like 
  <pre>try<br>{<br>	// Alternative syntax<br>	Node node1 = j.parse("z=i*pi");<br>	j.evaluate(node1);<br>	Node node2 = j.parse("exp(z)");<br>	Object val2 = j.evaluate(node2);<br>	System.out.println("Value: "+val2);<br>}<br>catch(ParseException e)	{<br>	System.out.println("Error with parsing");<br>}<br>catch(Exception e)	{<br>	System.out.println("Error with evaluation");<br>}</pre>
  <p>Hence its a bit easier to keep track of a number of equations. Note that 
    using this syntax Exceptions need to be caught and the <a href="../javadoc/org/nfunk/jep/JEP.html#getTopNode()">getTopNode()</a> 
    method will not return meaningful results.</p>
<!-- #BeginLibraryItem "/Library/top bar.lbi" -->
<div class="topbar"><a href="#top"><img src="img/top.gif" width="38" height="15" name="top"></a></div>
<!-- #EndLibraryItem --> 
  <h2><a name="implicitmul"></a>Implicit multiplication</h2>
  <p>You can enable the implicit multiplication option with <a href="../javadoc/org/nfunk/jep/JEP.html#setImplicitMul(boolean)" target="_blank">setImplicitMul(true)</a>. 
    The default setting is false (no implicit multiplication).</p>
  <p>Implicit multiplication allows expressions such as &quot;2 x&quot; to be 
    interpreted as &quot;2*x&quot;. Note that a space is required between two 
    variables for them to be interpreted as being multiplied. The same holds for 
    a variable followed by a number. For example &quot;y 3&quot; is interpreted 
    as &quot;y*3&quot;, but &quot;y3&quot; is interpreted as a single variable 
    with the name y3. If a variable is preceded by a number, no space is required 
    between them for implicit multiplication to come in effect.</p>
  
  <!-- #BeginLibraryItem "/Library/top bar.lbi" -->
<div class="topbar"><a href="#top"><img src="img/top.gif" width="38" height="15" name="top"></a></div>
<!-- #EndLibraryItem --> 
  <h2><a name="manipulating"></a>Manipulating expressions</h2>
  <p>The <a href="../javadoc/org/nfunk/jep/JEP.html#getTopNode()" target="_blank">getTopNode()</a> 
    method can be used to get the expression tree after parsing an expression. 
    This will be useful if you want to do more than just evaluate the expressions 
    you parse. For example, you may want to determine the derivative of an expression. 
    In order to be able to this, you will need direct access to the expression 
    tree.</p>
  <p>The expression tree consists of nodes. Each of the nodes in the parse tree 
    is an object of one of the following types:</p>
  <ul>
    <li><a href="../javadoc/org/nfunk/jep/ASTFunNode.html" target="_blank">ASTFunNode</a> 
      - Functions and operators</li>
    <li><a href="../javadoc/org/nfunk/jep/ASTConstant.html" target="_blank">ASTConstant</a> 
      - Constants</li>
    <li><a href="../javadoc/org/nfunk/jep/ASTVarNode.html" target="_blank">ASTVarNode</a> 
      - Variables</li>
  </ul>
  <p>All of them extend the <a href="../javadoc/org/nfunk/jep/SimpleNode.html" target="_blank">SimpleNode</a> 
    class (which implements the <a href="../javadoc/org/nfunk/jep/Node.html" target="_blank">Node</a> 
    interface). Binary operators (+,-,*,/...) and functions are ASTFunNodes. The 
    type of operator (the function class) is stored in the pfmc member, and as 
    a string in the name member. Use the <a href="../javadoc/org/nfunk/jep/ASTFunNode.html#getPFMC()" target="_blank">getPFMC()</a> 
    and <a href="../javadoc/org/nfunk/jep/ASTFunNode.html#getName()" target="_blank">getName()</a> 
    methods to access these members.</p>
  <p>To traverse the expression tree you can use a visitor class (<a href="../javadoc/org/nfunk/jep/ParserDumpVisitor.html" target="_blank">ParserDumpVisitor</a> 
    is an example class used to print out all the nodes). Look at the <a href="../javadoc/org/nfunk/jep/EvaluatorVisitor.html" target="_blank">EvaluatorVisitor</a> 
    class to see how expressions are evaluated using the Visitor design pattern.</p>
  <!-- #BeginLibraryItem "/Library/top bar.lbi" -->
<div class="topbar"><a href="#top"><img src="img/top.gif" width="38" height="15" name="top"></a></div>
<!-- #EndLibraryItem --> 
  <h2><a name="assignment"></a>Assignment</h2>
  <p> Assignment allows the values of variables to be set by using the <tt>=</tt> 
    operator in equations so it is possible to do something like <tt>x=3</tt> 
    then <tt>y=x^2</tt> and <tt>y</tt> will have the value 9. Assignment can be 
    used with the standard JEP package, there is no need to use any of the packages 
    in the org.lsmp.djep tree. To switch on assignment facilities the <a href="../javadoc/org/nfunk/jep/JEP.html#setAllowAssignment(boolean)">setAllowAssignment</a> 
    method of the main JEP object should be called. </p>
  <pre>// standard initialisation<br>JEP j = new JEP();<br>j.addStandardConstants();<br>j.addStandardFunctions();<br>j.addComplex();<br>j.setAllowUndeclared(true);<br>j.setImplicitMul(true);<br><br>// switch assignment facilities on<br>j.setAllowAssignment(true);<br><br>// parse assignment equations<br>j.parseExpression("x=3");<br>// evaluate it - no need to save the value returned (unless you want to)<br>j.getValueAsObject();<br>// parse a second equation<br>j.parseExpression("y=2");<br>j.getValueAsObject();<br><br>// an equation involving above variables<br>j.parseExpression("x^y");<br>Object val3 = j.getValueAsObject();<br>System.out.println("Value is "+val3);<br></pre>

  <!-- #EndEditable -->




<!-- FOOTER ---------------------------------------------------------- -->
<div id="footer">
&copy; 2006 Singular Systems
<a href="http://www.singularsys.com" target="_blank">www.singularsys.com</a>
</div>
</div>

</body>
<!-- #EndTemplate --></html>
