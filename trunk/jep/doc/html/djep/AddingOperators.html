<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><!-- #BeginTemplate "/Templates/maintemplate.dwt" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<!-- #BeginEditable "doctitle" --><title>Jep - adding operators to the parser</title><!-- #EndEditable --> 
<link rel="stylesheet" type="text/css" href="../main.css" title="style1">
</head>

<body>



<!-- NAVIGATION ---------------------------------------------------- -->
<div id="navcontainer"> 
  <ul>
    <li><a href="../../javadoc/index.html" target="_blank">JavaDoc*</a></li>
  </ul>

<h1>JEP</h1>
  <ul>
    <li><a href="../index.html">Basic Usage</a></li>
    <li><a href="../variables.html">Variables</a></li>
    <li><a href="../types.html">Data types</a></li>
    <li><a href="../op_and_func.html">Operators &amp; Functions</a></li>
    <li><a href="../grammar.html">Grammar</a></li>
    <li><a href="../cust_func.html">Custom Functions</a></li>
    <li><a href="../newfeatures.html">New Features</a></li>
    <li><a href="../faq.html">FAQ</a></li>
    <li><a href="../version.html">Version History</a></li>
  </ul>

<h1>Extensions</h1>
  <ul>
    <li><a href="index.html">DJEP</a></li>
    <li><a href="XJep.html">XJep</a></li>
    <li><a href="DJep.html">Differentiation</a></li>
    <li><a href="VectorJep.html">Vectors &amp; Matrices</a></li>
    <li><a href="GroupJep.html">Groups</a></li>
    <li><a href="AddingOperators.html">Adding Operators</a></li>
    <li><a href="version.html">Version History</a></li>
  </ul>
</div>



<div id="centercontent">
<!-- CENTER CONTENT -------------------------------------------------- -->
<!-- #BeginEditable "Text" --> 
        <h1><a name="top"></a>Adding operators to the parser</h1>
        
      <p><br>
	To add an operator to the parser several steps are needed:
	<ul>
	<li>Create a new <i>token</i> with the descriptive name AT, say, and a string representing the operator.
	<li>Modify the grammer rules to include a rule for the new operator<li>
	<li>Create a new object implementing org.nfunk.jep.function.PostfixMathCommandI to provide methods for evaluating the operator.
	<li>Modify or sub class org.nfunk.jep.OperatorSet to bind the operator in the parser to PostfixMathCommand
	</ul>
	Before atempting to add an operator you should be familiar with adding a <a href="../cust_func.html">custom function</a> to JEP.	
	</p>

	<h2>JavaCC The parser generator</h2>
	<p>
	Rather than writing the parser by hand in java the
	parser is created using the <a href="https://javacc.dev.java.net/">JavaCC</a> parser/scanner generator.
	This reads a file Parser.jjt which is written in a special language 
	which defines the grammer and creates Parser.java and some other java files
	which implement the parser.
	</p>
	<p>
	You should read some of the documentation on <a href="https://javacc.dev.java.net/doc/docindex.html/">JavaCC</a>
	and <a href="https://javacc.dev.java.net/doc/JJTree.html">JJTree</a> before attempting to modify the parser.
	</p>
	
	<p>
	There is a three step process used to generate the parser.
	<ol>
	<li>JJTree is run. This reads the file Parser.jjt and creates a file Parser.jj. 
	The purpose of this step is to add code needed to handle Abstract Systax Trees which are
	tree structures used represent a mathematical expression. As well as creating parser.jj it also creates
	some other java files: Node.java which represents the basic node in the parser;
	ASTConstant.java a node representing a constant value "0" or "1",
	ASTVarNode.java a node representing a variable, ASTFunNode.java a node representing
	a function or operator.
	<li>javacc is run. This reads Parser.jj and creates Parser.java the actual code for implementing the Parser.
	Parser.java is a very complicated file with nearly 2000 lines of code.
	<li>Normal java comilation step which compiles Parser.java.
	</ol>
	This process should automatically be caried out when the project is built using
	the ANT build.xml file. It is not sufficient to simple recompile 
	all the java files.
	</p>
	<p>Only the Parser.jjt file should be modified,
	Parser.jj, Parser.java should not be modified as they will be overwritten during the build process.
	Furthermore ASTConstant.java, ASTFunNode.java, ASTStart.java, ASTVarNode.java,
	JavaCharStream.java, JJTParserState.java, Node.java, SimpleNode.java, ParseException.java,
	ParserConstants.java, ParserTokenManager.java, ParseTreeConstants.java, Token.java,
	TokenMgrError.java should not normally be modified as these are also automatically generated.</p>

<!-- #BeginLibraryItem "/Library/top bar.lbi" -->
<div class="topbar"><a href="#top"><img src="../img/top.gif" width="38" height="15" name="top"></a></div>
<!-- #EndLibraryItem --><!-- #EndEditable -->




<!-- FOOTER ---------------------------------------------------------- -->
<div id="footer">
&copy; 2006 Singular Systems
<a href="http://www.singularsys.com" target="_blank">www.singularsys.com</a>
</div>
</div>

</body>
<!-- #EndTemplate --></html>
